"use strict";var ce=Object.defineProperty;var de=(e,t,n)=>t in e?ce(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var dt=(e,t,n)=>(de(e,typeof t!="symbol"?t+"":t,n),n);Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const m=require("obsidian");function Y(){}function Ht(e){return e()}function St(){return Object.create(null)}function T(e){e.forEach(Ht)}function vt(e){return typeof e=="function"}function Yt(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function fe(e){return Object.keys(e).length===0}function Wt(e){return e&&vt(e.destroy)?e.destroy:Y}function C(e,t){e.appendChild(t)}function W(e,t,n){e.insertBefore(t,n||null)}function N(e){e.parentNode&&e.parentNode.removeChild(e)}function x(e){return document.createElement(e)}function kt(e){return document.createTextNode(e)}function A(){return kt(" ")}function ue(){return kt("")}function Q(e,t,n,i){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)}function L(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function he(e){return Array.from(e.childNodes)}function pe(e,t){t=""+t,e.data!==t&&(e.data=t)}let bt;function z(e){bt=e}const R=[],ht=[];let q=[];const Lt=[],ge=Promise.resolve();let pt=!1;function me(){pt||(pt=!0,ge.then(Bt))}function gt(e){q.push(e)}const ft=new Set;let I=0;function Bt(){if(I!==0)return;const e=bt;do{try{for(;I<R.length;){const t=R[I];I++,z(t),we(t.$$)}}catch(t){throw R.length=0,I=0,t}for(z(null),R.length=0,I=0;ht.length;)ht.pop()();for(let t=0;t<q.length;t+=1){const n=q[t];ft.has(n)||(ft.add(n),n())}q.length=0}while(R.length);for(;Lt.length;)Lt.pop()();pt=!1,ft.clear(),z(e)}function we(e){if(e.fragment!==null){e.update(),T(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(gt)}}function ye(e){const t=[],n=[];q.forEach(i=>e.indexOf(i)===-1?t.push(i):n.push(i)),n.forEach(i=>i()),q=t}const at=new Set;let H;function ve(){H={r:0,c:[],p:H}}function ke(){H.r||T(H.c),H=H.p}function ct(e,t){e&&e.i&&(at.delete(e),e.i(t))}function Et(e,t,n,i){if(e&&e.o){if(at.has(e))return;at.add(e),H.c.push(()=>{at.delete(e),i&&(n&&e.d(1),i())}),e.o(t)}else i&&i()}function _t(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function be(e,t){Et(e,1,1,()=>{t.delete(e.key)})}function Ee(e,t,n,i,o,s,r,a,f,l,d,c){let u=e.length,w=s.length,k=u;const y={};for(;k--;)y[e[k].key]=k;const g=[],h=new Map,p=new Map,b=[];for(k=w;k--;){const S=c(o,s,k),_=n(S);let $=r.get(_);$?b.push(()=>$.p(S,t)):($=l(_,S),$.c()),h.set(_,g[k]=$),_ in y&&p.set(_,Math.abs(k-y[_]))}const M=new Set,F=new Set;function O(S){ct(S,1),S.m(a,d),r.set(S.key,S),d=S.first,w--}for(;u&&w;){const S=g[w-1],_=e[u-1],$=S.key,B=_.key;S===_?(d=S.first,u--,w--):h.has(B)?!r.has($)||M.has($)?O(S):F.has(B)?u--:p.get($)>p.get(B)?(F.add($),O(S)):(M.add(B),u--):(f(_,r),u--)}for(;u--;){const S=e[u];h.has(S.key)||f(S,r)}for(;w;)O(g[w-1]);return T(b),g}function Se(e){e&&e.c()}function It(e,t,n){const{fragment:i,after_update:o}=e.$$;i&&i.m(t,n),gt(()=>{const s=e.$$.on_mount.map(Ht).filter(vt);e.$$.on_destroy?e.$$.on_destroy.push(...s):T(s),e.$$.on_mount=[]}),o.forEach(gt)}function Rt(e,t){const n=e.$$;n.fragment!==null&&(ye(n.after_update),T(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Le(e,t){e.$$.dirty[0]===-1&&(R.push(e),me(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function jt(e,t,n,i,o,s,r=null,a=[-1]){const f=bt;z(e);const l=e.$$={fragment:null,ctx:[],props:s,update:Y,not_equal:o,bound:St(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(f?f.$$.context:[])),callbacks:St(),dirty:a,skip_bound:!1,root:t.target||f.$$.root};r&&r(l.root);let d=!1;if(l.ctx=n?n(e,t.props||{},(c,u,...w)=>{const k=w.length?w[0]:u;return l.ctx&&o(l.ctx[c],l.ctx[c]=k)&&(!l.skip_bound&&l.bound[c]&&l.bound[c](k),d&&Le(e,c)),u}):[],l.update(),d=!0,T(l.before_update),l.fragment=i?i(l.ctx):!1,t.target){if(t.hydrate){const c=he(t.target);l.fragment&&l.fragment.l(c),c.forEach(N)}else l.fragment&&l.fragment.c();t.intro&&ct(e.$$.fragment),It(e,t.target,t.anchor),Bt()}z(f)}class qt{constructor(){dt(this,"$$");dt(this,"$$set")}$destroy(){Rt(this,1),this.$destroy=Y}$on(t,n){if(!vt(n))return Y;const i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(n),()=>{const o=i.indexOf(n);o!==-1&&i.splice(o,1)}}$set(t){this.$$set&&!fe(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const _e="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(_e);function $e(e,t,n,i){function o(s){return s instanceof n?s:new n(function(r){r(s)})}return new(n||(n=Promise))(function(s,r){function a(d){try{l(i.next(d))}catch(c){r(c)}}function f(d){try{l(i.throw(d))}catch(c){r(c)}}function l(d){d.done?s(d.value):o(d.value).then(a,f)}l((i=i.apply(e,[])).next())})}function Vt(e){const t=[];for(let n=0;n<e;n++)t.push((16*Math.random()|0).toString(16));return t.join("")}const it=new WeakMap;function $t(e){return e.containerEl.matches(".dn-editor.dn-leaf-view .workspace-leaf")}function Ce(e){const t=function(){return Object.setPrototypeOf(new m.Component,new.target.prototype)};return t.prototype=e.prototype,Object.setPrototypeOf(t,e)}const xe=(e,t,n,i)=>{let o=e.app.workspace.activeLeaf;o||(o=n),t||(t=o==null?void 0:o.containerEl);const s=new Z(o,t,e,void 0,i);return[s.attachLeaf(),s]};class Z extends Ce(m.HoverPopover){constructor(t,n,i,o,s){var a,f;super(),this.targetEl=n,this.plugin=i,this.onShowCallback=s,this.abortController=this.addChild(new m.Component),this.detaching=!1,this.opening=!1,this.rootSplit=new m.WorkspaceSplit(window.app.workspace,"vertical"),this.isPinned=!0,this.oldPopover=(a=this.parent)==null?void 0:a.DailyNoteEditor,this.id=Vt(8),o===void 0&&(o=300),this.onTarget=!0,this.parent=t,this.waitTime=o,this.state=m.PopoverState.Showing,this.document=((f=this.targetEl)==null?void 0:f.ownerDocument)??window.activeDocument??window.document,this.hoverEl=this.document.defaultView.createDiv({cls:"dn-editor dn-leaf-view",attr:{id:"dn-"+this.id}});const{hoverEl:r}=this;this.abortController.load(),this.timer=window.setTimeout(this.show.bind(this),o),this.setActive=this._setActive.bind(this),r&&r.addEventListener("mousedown",this.setActive),it.set(this.hoverEl,this),this.hoverEl.addClass("dn-editor"),this.containerEl=this.hoverEl.createDiv("dn-content"),this.buildWindowControls(),this.setInitialDimensions()}static activeWindows(){const t=[window],{floatingSplit:n}=app.workspace;if(n)for(const i of n.children)i.win&&t.push(i.win);return t}static containerForDocument(t,n){if(n!==document&&t.app.workspace.floatingSplit){for(const i of t.app.workspace.floatingSplit.children)if(i.doc===n)return i}return t.app.workspace.rootSplit}static activePopovers(){return this.activeWindows().flatMap(this.popoversForWindow)}static popoversForWindow(t){var n;return Array.prototype.slice.call(((n=t==null?void 0:t.document)==null?void 0:n.body.querySelectorAll(".dn-leaf-view"))??[]).map(i=>it.get(i)).filter(i=>i)}static forLeaf(t){const n=t&&document.body.matchParent.call(t.containerEl,".dn-leaf-view");return n?it.get(n):void 0}static iteratePopoverLeaves(t,n){for(const i of this.activePopovers())if(i.rootSplit&&t.iterateLeaves(n,i.rootSplit))return!0;return!1}_setActive(t){t.preventDefault(),t.stopPropagation(),this.plugin.app.workspace.setActiveLeaf(this.leaves()[0],{focus:!0})}getDefaultMode(){return"source"}updateLeaves(){this.onTarget&&this.targetEl&&!this.document.contains(this.targetEl)&&(this.onTarget=!1,this.transition());let t=0;this.plugin.app.workspace.iterateLeaves(n=>{t++},this.rootSplit),t===0&&this.hide(),this.hoverEl.setAttribute("data-leaf-count",t.toString())}leaves(){const t=[];return this.plugin.app.workspace.iterateLeaves(n=>{t.push(n)},this.rootSplit),t}setInitialDimensions(){this.hoverEl.style.height="auto",this.hoverEl.style.width="100%"}transition(){this.shouldShow()?this.state===m.PopoverState.Hiding&&(this.state=m.PopoverState.Shown,clearTimeout(this.timer)):this.state===m.PopoverState.Showing?this.hide():this.state===m.PopoverState.Shown&&(this.state=m.PopoverState.Hiding,this.timer=window.setTimeout(()=>{this.shouldShow()?this.transition():this.hide()},this.waitTime))}buildWindowControls(){this.titleEl=this.document.defaultView.createDiv("popover-titlebar"),this.titleEl.createDiv("popover-title"),this.containerEl.prepend(this.titleEl)}attachLeaf(){this.rootSplit.getRoot=()=>this.plugin.app.workspace[this.document===document?"rootSplit":"floatingSplit"],this.rootSplit.getContainer=()=>Z.containerForDocument(this.plugin,this.document),this.titleEl.insertAdjacentElement("afterend",this.rootSplit.containerEl);const t=this.plugin.app.workspace.createLeafInParent(this.rootSplit,0);return this.updateLeaves(),t}onload(){super.onload(),this.registerEvent(this.plugin.app.workspace.on("layout-change",this.updateLeaves,this)),this.registerEvent(app.workspace.on("layout-change",()=>{this.rootSplit.children.forEach((t,n)=>{t instanceof m.WorkspaceTabs&&this.rootSplit.replaceChild(n,t.children[0])})}))}onShow(){var s,r;setTimeout(()=>this.waitTime=600,600),(s=this.oldPopover)==null||s.hide(),this.oldPopover=null,this.hoverEl.toggleClass("is-new",!0),this.document.body.addEventListener("click",()=>{this.hoverEl.toggleClass("is-new",!1)},{once:!0,capture:!0}),this.parent&&(this.parent.DailyNoteEditor=this);const n=this.hoverEl.querySelector(".view-header");n==null||n.remove();const i=this.hoverEl.querySelector(".workspace-leaf");i&&this.hoverEl.appendChild(i);const o=this.hoverEl.querySelector(".inline-title");o&&o.remove(),(r=this.onShowCallback)==null||r.call(this),this.onShowCallback=void 0}detect(t){const{targetEl:n}=this;n&&(this.onTarget=t===n||n.contains(t))}shouldShow(){return this.shouldShowSelf()||this.shouldShowChild()}shouldShowChild(){return Z.activePopovers().some(t=>t!==this&&t.targetEl&&this.hoverEl.contains(t.targetEl)?t.shouldShow():!1)}shouldShowSelf(){return!this.detaching&&!!(this.onTarget||this.state==m.PopoverState.Shown||this.document.querySelector(`body>.modal-container, body > #he${this.id} ~ .menu, body > #he${this.id} ~ .suggestion-container`))}show(){!this.targetEl||this.document.body.contains(this.targetEl)?(this.state=m.PopoverState.Shown,this.timer=0,this.targetEl.appendChild(this.hoverEl),this.onShow(),app.workspace.onLayoutChange(),this.load()):this.hide(),this.hoverEl.dataset.imgHeight&&this.hoverEl.dataset.imgWidth&&(this.hoverEl.style.height=parseFloat(this.hoverEl.dataset.imgHeight)+this.titleEl.offsetHeight+"px",this.hoverEl.style.width=parseFloat(this.hoverEl.dataset.imgWidth)+"px")}onHide(){var t;this.oldPopover=null,((t=this.parent)==null?void 0:t.DailyNoteEditor)===this&&(this.parent.DailyNoteEditor=null)}hide(){var n;if(this.onTarget=!1,this.detaching=!0,this.timer&&(clearTimeout(this.timer),this.timer=0),this.hoverEl.hide(),this.opening)return;const t=this.leaves();if(t.length)t[0].detach();else return this.parent=null,(n=this.abortController)==null||n.unload(),this.abortController=void 0,this.nativeHide()}nativeHide(){var i;const{hoverEl:t,targetEl:n}=this;if(this.state=m.PopoverState.Hidden,t.detach(),n){const o=n.matchParent(".dn-leaf-view");o&&((i=it.get(o))==null||i.transition())}this.onHide(),this.unload()}resolveLink(t,n){const i=m.parseLinktext(t);return i?this.plugin.app.metadataCache.getFirstLinkpathDest(i.path,n):null}async openLink(t,n,i,o){var w,k,y;let s=this.resolveLink(t,n);const r=m.parseLinktext(t);if(!s&&o){const g=this.plugin.app.fileManager.getNewFileParent(n);s=await this.plugin.app.fileManager.createNewMarkdownFile(g,r.path)}if(!s)return;const{viewRegistry:a}=this.plugin.app,f=a.typeByExtension[s.extension];if(!f||!a.viewByType[f])return;i=Object.assign(this.buildEphemeralState(s,r),i);const l=this.getDefaultMode(),d=this.buildState(l,i),c=await this.openFile(s,d,o),u=(w=c==null?void 0:c.view)==null?void 0:w.getViewType();if(u==="image"){(k=this.parent)!=null&&k.hasOwnProperty("editorEl")&&this.parent.editorEl.hasClass("is-live-preview")&&(this.waitTime=3e3);const g=c.view.contentEl.querySelector("img");this.hoverEl.dataset.imgHeight=String(g.naturalHeight),this.hoverEl.dataset.imgWidth=String(g.naturalWidth),this.hoverEl.dataset.imgRatio=String(g.naturalWidth/g.naturalHeight)}else u==="pdf"&&(this.hoverEl.style.height="800px",this.hoverEl.style.width="600px");((y=d.state)==null?void 0:y.mode)==="source"&&this.whenShown(()=>{var g,h,p,b;m.requireApiVersion("1.0")&&((p=(h=(g=c==null?void 0:c.view)==null?void 0:g.editMode)==null?void 0:h.reinit)==null||p.call(h)),(b=c==null?void 0:c.view)==null||b.setEphemeralState(d.eState)})}whenShown(t){if(this.detaching)return;const n=this.onShowCallback;this.onShowCallback=()=>{this.detaching||(t(),typeof n=="function"&&n())},this.state===m.PopoverState.Shown&&(this.onShowCallback(),this.onShowCallback=void 0)}async openFile(t,n,i){if(this.detaching)return;const o=i??this.attachLeaf();this.opening=!0;try{await o.openFile(t,n)}catch(s){console.error(s)}finally{this.opening=!1,this.detaching&&this.hide()}return this.plugin.app.workspace.setActiveLeaf(o),o}buildState(t,n){return{active:!1,state:{mode:"source"},eState:n}}buildEphemeralState(t,n){const i=this.plugin.app.metadataCache.getFileCache(t),o=i?m.resolveSubpath(i,(n==null?void 0:n.subpath)||""):void 0,s={subpath:n==null?void 0:n.subpath};return o&&(s.line=o.start.line,s.startLoc=o.start,s.endLoc=o.end||void 0),s}}function Pe(e){return e()}function Me(e){e.forEach(Pe)}const ot=[],Ct=[],lt=[],xt=[],Ut=Promise.resolve();let mt=!1;function Fe(){mt||(mt=!0,Ut.then(Ne))}function De(){return Fe(),Ut}function Te(e){lt.push(e)}const ut=new Set;let st=0;function Ne(){do{for(;st<ot.length;){const e=ot[st];st++,Oe(e.$$)}for(ot.length=0,st=0;Ct.length;)Ct.pop()();for(let e=0;e<lt.length;e+=1){const t=lt[e];ut.has(t)||(ut.add(t),t())}lt.length=0}while(ot.length);for(;xt.length;)xt.pop()();mt=!1,ut.clear()}function Oe(e){if(e.fragment!==null){e.update(),Me(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Te)}}const Ae={root:null,rootMargin:"0px",threshold:0,unobserveOnEnter:!1},D=(e,t)=>new CustomEvent(e,{detail:t});function zt(e,t={}){const{root:n,rootMargin:i,threshold:o,unobserveOnEnter:s}=Object.assign(Object.assign({},Ae),t);let r={x:void 0,y:void 0},a={vertical:void 0,horizontal:void 0};if(typeof IntersectionObserver<"u"&&e){const f=new IntersectionObserver((l,d)=>{l.forEach(c=>{r.y>c.boundingClientRect.y?a.vertical="up":a.vertical="down",r.x>c.boundingClientRect.x?a.horizontal="left":a.horizontal="right",r={y:c.boundingClientRect.y,x:c.boundingClientRect.x};const u={inView:c.isIntersecting,entry:c,scrollDirection:a,node:e,observer:d};e.dispatchEvent(D("inview_change",u)),e.dispatchEvent(D("change",u)),c.isIntersecting?(e.dispatchEvent(D("inview_enter",u)),e.dispatchEvent(D("enter",u)),s&&d.unobserve(e)):(e.dispatchEvent(D("inview_leave",u)),e.dispatchEvent(D("leave",u)))})},{root:n,rootMargin:i,threshold:o});return De().then(()=>{e.dispatchEvent(D("inview_init",{observer:f,node:e})),e.dispatchEvent(D("init",{observer:f,node:e}))}),f.observe(e),{destroy(){f.unobserve(e)}}}}function Pt(e){let t,n,i,o,s,r;return{c(){t=x("div"),n=kt(e[1]),i=A(),o=x("div"),o.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-symlink"><path d="m10 18 3-3-3-3"></path><path d="M14 2v4a2 2 0 0 0 2 2h4"></path><path d="M4 11V4a2 2 0 0 1 2-2h9l5 5v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h7"></path></svg>',L(o,"class","daily-node-icon clickable-icon svelte-18gimyz"),L(o,"aria-hidden","true"),L(t,"class","daily-note-title inline-title svelte-18gimyz")},m(a,f){W(a,t,f),C(t,n),C(t,i),C(t,o),s||(r=Q(o,"click",e[3]),s=!0)},p(a,f){f&2&&pe(n,a[1])},d(a){a&&N(t),s=!1,r()}}}function He(e){let t,n,i,o,s,r,a,f,l,d=e[1]&&Pt(e);return{c(){t=x("div"),n=x("div"),d&&d.c(),i=A(),o=x("div"),s=A(),r=x("div"),L(o,"class","daily-note-editor"),L(o,"aria-label",e[1]),L(n,"class","daily-note svelte-18gimyz"),L(t,"class","daily-note-container"),L(t,"aria-label",a="dn-editor-"+e[2])},m(c,u){W(c,t,u),C(t,n),d&&d.m(n,null),C(n,i),C(n,o),e[8](o),C(t,s),C(t,r),f||(l=[Wt(zt.call(null,r,{rootMargin:"20%"})),Q(r,"inview_enter",e[4])],f=!0)},p(c,[u]){c[1]?d?d.p(c,u):(d=Pt(c),d.c(),d.m(n,i)):d&&(d.d(1),d=null),u&2&&L(o,"aria-label",c[1]),u&4&&a!==(a="dn-editor-"+c[2])&&L(t,"aria-label",a)},i:Y,o:Y,d(c){c&&N(t),d&&d.d(),e[8](null),f=!1,T(l)}}}function Ye(e,t,n){let{file:i}=t,{plugin:o}=t,{leaf:s}=t,r,a,f=!1,l,d;function c(){i instanceof m.TFile&&(f||(n(1,a=i.basename),[d]=xe(o,r,s),d.setPinned(!0),d.openFile(i,{active:!1,state:{mode:"source",backlinks:!o.settings.hideBacklinks}}),d.parentLeaf=s,f=!0))}function u(){i instanceof m.TFile&&(s?s.openFile(i):o.app.workspace.getLeaf(!1).openFile(i))}function w(y){const{scrollDirection:g}=y.detail;g.vertical==="down"&&c()}function k(y){ht[y?"unshift":"push"](()=>{r=y,n(0,r)})}return e.$$set=y=>{"file"in y&&n(5,i=y.file),"plugin"in y&&n(6,o=y.plugin),"leaf"in y&&n(7,s=y.leaf)},e.$$.update=()=>{e.$$.dirty&1&&r&&(c(),n(2,l=Vt(8)))},[r,a,l,u,w,i,o,s,k]}class We extends qt{constructor(t){super(),jt(this,t,Ye,He,Yt,{file:5,plugin:6,leaf:7})}}var v={};Object.defineProperty(v,"__esModule",{value:!0});var E=m;const wt="YYYY-MM-DD",yt="gggg-[W]ww",Qt="YYYY-MM",Zt="YYYY-[Q]Q",Gt="YYYY";function G(e){var n,i;const t=window.app.plugins.getPlugin("periodic-notes");return t&&((i=(n=t.settings)==null?void 0:n[e])==null?void 0:i.enabled)}function K(){var e,t,n,i;try{const{internalPlugins:o,plugins:s}=window.app;if(G("daily")){const{format:l,folder:d,template:c}=((t=(e=s.getPlugin("periodic-notes"))==null?void 0:e.settings)==null?void 0:t.daily)||{};return{format:l||wt,folder:(d==null?void 0:d.trim())||"",template:(c==null?void 0:c.trim())||""}}const{folder:r,format:a,template:f}=((i=(n=o.getPluginById("daily-notes"))==null?void 0:n.instance)==null?void 0:i.options)||{};return{format:a||wt,folder:(r==null?void 0:r.trim())||"",template:(f==null?void 0:f.trim())||""}}catch{}}function J(){var e,t,n,i,o,s,r;try{const a=window.app.plugins,f=(e=a.getPlugin("calendar"))==null?void 0:e.options,l=(n=(t=a.getPlugin("periodic-notes"))==null?void 0:t.settings)==null?void 0:n.weekly;if(G("weekly"))return{format:l.format||yt,folder:((i=l.folder)==null?void 0:i.trim())||"",template:((o=l.template)==null?void 0:o.trim())||""};const d=f||{};return{format:d.weeklyNoteFormat||yt,folder:((s=d.weeklyNoteFolder)==null?void 0:s.trim())||"",template:((r=d.weeklyNoteTemplate)==null?void 0:r.trim())||""}}catch{}}function X(){var t,n,i,o;const e=window.app.plugins;try{const s=G("monthly")&&((n=(t=e.getPlugin("periodic-notes"))==null?void 0:t.settings)==null?void 0:n.monthly)||{};return{format:s.format||Qt,folder:((i=s.folder)==null?void 0:i.trim())||"",template:((o=s.template)==null?void 0:o.trim())||""}}catch{}}function tt(){var t,n,i,o;const e=window.app.plugins;try{const s=G("quarterly")&&((n=(t=e.getPlugin("periodic-notes"))==null?void 0:t.settings)==null?void 0:n.quarterly)||{};return{format:s.format||Zt,folder:((i=s.folder)==null?void 0:i.trim())||"",template:((o=s.template)==null?void 0:o.trim())||""}}catch{}}function et(){var t,n,i,o;const e=window.app.plugins;try{const s=G("yearly")&&((n=(t=e.getPlugin("periodic-notes"))==null?void 0:t.settings)==null?void 0:n.yearly)||{};return{format:s.format||Gt,folder:((i=s.folder)==null?void 0:i.trim())||"",template:((o=s.template)==null?void 0:o.trim())||""}}catch{}}function Kt(...e){let t=[];for(let i=0,o=e.length;i<o;i++)t=t.concat(e[i].split("/"));const n=[];for(let i=0,o=t.length;i<o;i++){const s=t[i];!s||s==="."||n.push(s)}return t[0]===""&&n.unshift(""),n.join("/")}function Be(e){let t=e.substring(e.lastIndexOf("/")+1);return t.lastIndexOf(".")!=-1&&(t=t.substring(0,t.lastIndexOf("."))),t}async function Ie(e){const t=e.replace(/\\/g,"/").split("/");if(t.pop(),t.length){const n=Kt(...t);window.app.vault.getAbstractFileByPath(n)||await window.app.vault.createFolder(n)}}async function nt(e,t){t.endsWith(".md")||(t+=".md");const n=E.normalizePath(Kt(e,t));return await Ie(n),n}async function V(e){const{metadataCache:t,vault:n}=window.app,i=E.normalizePath(e);if(i==="/")return Promise.resolve(["",null]);try{const o=t.getFirstLinkpathDest(i,""),s=await n.cachedRead(o),r=window.app.foldManager.load(o);return[s,r]}catch(o){return console.error(`Failed to read the daily note template '${i}'`,o),new E.Notice("Failed to read the daily note template"),["",null]}}function P(e,t="day"){const n=e.clone().startOf(t).format();return`${t}-${n}`}function Jt(e){return e.replace(/\[[^\]]*\]/g,"")}function Re(e,t){if(t==="week"){const n=Jt(e);return/w{1,2}/i.test(n)&&(/M{1,4}/.test(n)||/D{1,4}/.test(n))}return!1}function U(e,t){return Xt(e.basename,t)}function je(e,t){return Xt(Be(e),t)}function Xt(e,t){const i={day:K,week:J,month:X,quarter:tt,year:et}[t]().format.split("/").pop(),o=window.moment(e,i,!0);if(!o.isValid())return null;if(Re(i,t)&&t==="week"){const s=Jt(i);if(/w{1,2}/i.test(s))return window.moment(e,i.replace(/M{1,4}/g,"").replace(/D{1,4}/g,""),!1)}return o}class qe extends Error{}async function te(e){const t=window.app,{vault:n}=t,i=window.moment,{template:o,format:s,folder:r}=K(),[a,f]=await V(o),l=e.format(s),d=await nt(r,l);try{const c=await n.create(d,a.replace(/{{\s*date\s*}}/gi,l).replace(/{{\s*time\s*}}/gi,i().format("HH:mm")).replace(/{{\s*title\s*}}/gi,l).replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(u,w,k,y,g,h)=>{const p=i(),b=e.clone().set({hour:p.get("hour"),minute:p.get("minute"),second:p.get("second")});return k&&b.add(parseInt(y,10),g),h?b.format(h.substring(1).trim()):b.format(s)}).replace(/{{\s*yesterday\s*}}/gi,e.clone().subtract(1,"day").format(s)).replace(/{{\s*tomorrow\s*}}/gi,e.clone().add(1,"d").format(s)));return t.foldManager.save(c,f),c}catch(c){console.error(`Failed to create file: '${d}'`,c),new E.Notice("Unable to create new file.")}}function Ve(e,t){return t[P(e,"day")]??null}function Ue(){const{vault:e}=window.app,{folder:t}=K(),n=e.getAbstractFileByPath(E.normalizePath(t));if(!n)throw new qe("Failed to find daily notes folder");const i={};return E.Vault.recurseChildren(n,o=>{if(o instanceof E.TFile){const s=U(o,"day");if(s){const r=P(s,"day");i[r]=o}}}),i}class ze extends Error{}function Qe(){const{moment:e}=window;let t=e.localeData()._week.dow;const n=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];for(;t;)n.push(n.shift()),t--;return n}function Ze(e){return Qe().indexOf(e.toLowerCase())}async function ee(e){const{vault:t}=window.app,{template:n,format:i,folder:o}=J(),[s,r]=await V(n),a=e.format(i),f=await nt(o,a);try{const l=await t.create(f,s.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(d,c,u,w,k,y)=>{const g=window.moment(),h=e.clone().set({hour:g.get("hour"),minute:g.get("minute"),second:g.get("second")});return u&&h.add(parseInt(w,10),k),y?h.format(y.substring(1).trim()):h.format(i)}).replace(/{{\s*title\s*}}/gi,a).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*(sunday|monday|tuesday|wednesday|thursday|friday|saturday)\s*:(.*?)}}/gi,(d,c,u)=>{const w=Ze(c);return e.weekday(w).format(u.trim())}));return window.app.foldManager.save(l,r),l}catch(l){console.error(`Failed to create file: '${f}'`,l),new E.Notice("Unable to create new file.")}}function Ge(e,t){return t[P(e,"week")]??null}function Ke(){const e={};if(!ie())return e;const{vault:t}=window.app,{folder:n}=J(),i=t.getAbstractFileByPath(E.normalizePath(n));if(!i)throw new ze("Failed to find weekly notes folder");return E.Vault.recurseChildren(i,o=>{if(o instanceof E.TFile){const s=U(o,"week");if(s){const r=P(s,"week");e[r]=o}}}),e}class Je extends Error{}async function ne(e){const{vault:t}=window.app,{template:n,format:i,folder:o}=X(),[s,r]=await V(n),a=e.format(i),f=await nt(o,a);try{const l=await t.create(f,s.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(d,c,u,w,k,y)=>{const g=window.moment(),h=e.clone().set({hour:g.get("hour"),minute:g.get("minute"),second:g.get("second")});return u&&h.add(parseInt(w,10),k),y?h.format(y.substring(1).trim()):h.format(i)}).replace(/{{\s*date\s*}}/gi,a).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,a));return window.app.foldManager.save(l,r),l}catch(l){console.error(`Failed to create file: '${f}'`,l),new E.Notice("Unable to create new file.")}}function Xe(e,t){return t[P(e,"month")]??null}function tn(){const e={};if(!oe())return e;const{vault:t}=window.app,{folder:n}=X(),i=t.getAbstractFileByPath(E.normalizePath(n));if(!i)throw new Je("Failed to find monthly notes folder");return E.Vault.recurseChildren(i,o=>{if(o instanceof E.TFile){const s=U(o,"month");if(s){const r=P(s,"month");e[r]=o}}}),e}class en extends Error{}async function nn(e){const{vault:t}=window.app,{template:n,format:i,folder:o}=tt(),[s,r]=await V(n),a=e.format(i),f=await nt(o,a);try{const l=await t.create(f,s.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(d,c,u,w,k,y)=>{const g=window.moment(),h=e.clone().set({hour:g.get("hour"),minute:g.get("minute"),second:g.get("second")});return u&&h.add(parseInt(w,10),k),y?h.format(y.substring(1).trim()):h.format(i)}).replace(/{{\s*date\s*}}/gi,a).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,a));return window.app.foldManager.save(l,r),l}catch(l){console.error(`Failed to create file: '${f}'`,l),new E.Notice("Unable to create new file.")}}function on(e,t){return t[P(e,"quarter")]??null}function sn(){const e={};if(!se())return e;const{vault:t}=window.app,{folder:n}=tt(),i=t.getAbstractFileByPath(E.normalizePath(n));if(!i)throw new en("Failed to find quarterly notes folder");return E.Vault.recurseChildren(i,o=>{if(o instanceof E.TFile){const s=U(o,"quarter");if(s){const r=P(s,"quarter");e[r]=o}}}),e}class rn extends Error{}async function an(e){const{vault:t}=window.app,{template:n,format:i,folder:o}=et(),[s,r]=await V(n),a=e.format(i),f=await nt(o,a);try{const l=await t.create(f,s.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(d,c,u,w,k,y)=>{const g=window.moment(),h=e.clone().set({hour:g.get("hour"),minute:g.get("minute"),second:g.get("second")});return u&&h.add(parseInt(w,10),k),y?h.format(y.substring(1).trim()):h.format(i)}).replace(/{{\s*date\s*}}/gi,a).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,a));return window.app.foldManager.save(l,r),l}catch(l){console.error(`Failed to create file: '${f}'`,l),new E.Notice("Unable to create new file.")}}function ln(e,t){return t[P(e,"year")]??null}function cn(){const e={};if(!re())return e;const{vault:t}=window.app,{folder:n}=et(),i=t.getAbstractFileByPath(E.normalizePath(n));if(!i)throw new rn("Failed to find yearly notes folder");return E.Vault.recurseChildren(i,o=>{if(o instanceof E.TFile){const s=U(o,"year");if(s){const r=P(s,"year");e[r]=o}}}),e}function dn(){var i,o;const{app:e}=window,t=e.internalPlugins.plugins["daily-notes"];if(t&&t.enabled)return!0;const n=e.plugins.getPlugin("periodic-notes");return n&&((o=(i=n.settings)==null?void 0:i.daily)==null?void 0:o.enabled)}function ie(){var n,i;const{app:e}=window;if(e.plugins.getPlugin("calendar"))return!0;const t=e.plugins.getPlugin("periodic-notes");return t&&((i=(n=t.settings)==null?void 0:n.weekly)==null?void 0:i.enabled)}function oe(){var n,i;const{app:e}=window,t=e.plugins.getPlugin("periodic-notes");return t&&((i=(n=t.settings)==null?void 0:n.monthly)==null?void 0:i.enabled)}function se(){var n,i;const{app:e}=window,t=e.plugins.getPlugin("periodic-notes");return t&&((i=(n=t.settings)==null?void 0:n.quarterly)==null?void 0:i.enabled)}function re(){var n,i;const{app:e}=window,t=e.plugins.getPlugin("periodic-notes");return t&&((i=(n=t.settings)==null?void 0:n.yearly)==null?void 0:i.enabled)}function fn(e){const t={day:K,week:J,month:X,quarter:tt,year:et}[e];return t()}function un(e,t){return{day:te,month:ne,week:ee}[e](t)}v.DEFAULT_DAILY_NOTE_FORMAT=wt;v.DEFAULT_MONTHLY_NOTE_FORMAT=Qt;v.DEFAULT_QUARTERLY_NOTE_FORMAT=Zt;v.DEFAULT_WEEKLY_NOTE_FORMAT=yt;v.DEFAULT_YEARLY_NOTE_FORMAT=Gt;v.appHasDailyNotesPluginLoaded=dn;v.appHasMonthlyNotesPluginLoaded=oe;v.appHasQuarterlyNotesPluginLoaded=se;v.appHasWeeklyNotesPluginLoaded=ie;v.appHasYearlyNotesPluginLoaded=re;var hn=v.createDailyNote=te;v.createMonthlyNote=ne;v.createPeriodicNote=un;v.createQuarterlyNote=nn;v.createWeeklyNote=ee;v.createYearlyNote=an;var pn=v.getAllDailyNotes=Ue;v.getAllMonthlyNotes=tn;v.getAllQuarterlyNotes=sn;v.getAllWeeklyNotes=Ke;v.getAllYearlyNotes=cn;var gn=v.getDailyNote=Ve,Mt=v.getDailyNoteSettings=K,Ft=v.getDateFromFile=U;v.getDateFromPath=je;v.getDateUID=P;v.getMonthlyNote=Xe;v.getMonthlyNoteSettings=X;v.getPeriodicNoteSettings=fn;v.getQuarterlyNote=on;v.getQuarterlyNoteSettings=tt;v.getTemplateInfo=V;v.getWeeklyNote=Ge;v.getWeeklyNoteSettings=J;v.getYearlyNote=ln;v.getYearlyNoteSettings=et;function Dt(e,t,n){const i=e.slice();return i[15]=t[n],i}function Tt(e){let t;return{c(){t=x("div"),L(t,"class","dn-stock svelte-101lm3m")},m(n,i){W(n,t,i)},d(n){n&&N(t)}}}function Nt(e){let t,n,i;return{c(){t=x("div"),t.innerHTML='<div class="dn-blank-day-text svelte-101lm3m">Create a daily note for today ✍</div>',L(t,"class","dn-blank-day svelte-101lm3m"),L(t,"aria-hidden","true")},m(o,s){W(o,t,s),n||(i=Q(t,"click",e[5]),n=!0)},p:Y,d(o){o&&N(t),n=!1,i()}}}function Ot(e,t){let n,i,o;return i=new We({props:{file:t[15],plugin:t[0],leaf:t[1]}}),{key:e,first:null,c(){n=ue(),Se(i.$$.fragment),this.first=n},m(s,r){W(s,n,r),It(i,s,r),o=!0},p(s,r){t=s;const a={};r&8&&(a.file=t[15]),r&1&&(a.plugin=t[0]),r&2&&(a.leaf=t[1]),i.$set(a)},i(s){o||(ct(i.$$.fragment,s),o=!0)},o(s){Et(i.$$.fragment,s),o=!1},d(s){s&&N(n),Rt(i,s)}}}function At(e){let t;return{c(){t=x("div"),t.textContent="—— No more of results ——",L(t,"class","no-more-text svelte-101lm3m")},m(n,i){W(n,t,i)},d(n){n&&N(t)}}}function mn(e){let t,n,i,o=[],s=new Map,r,a,f,l,d,c,u=e[3].length===0&&Tt(),w=!e[4]&&Nt(e),k=_t(e[3]);const y=h=>h[15];for(let h=0;h<k.length;h+=1){let p=Dt(e,k,h),b=y(p);s.set(b,o[h]=Ot(b,p))}let g=!e[2]&&At();return{c(){t=x("div"),u&&u.c(),n=A(),w&&w.c(),i=A();for(let h=0;h<o.length;h+=1)o[h].c();r=A(),a=x("div"),f=A(),g&&g.c(),L(t,"class","daily-note-view")},m(h,p){W(h,t,p),u&&u.m(t,null),C(t,n),w&&w.m(t,null),C(t,i);for(let b=0;b<o.length;b+=1)o[b]&&o[b].m(t,null);C(t,r),C(t,a),C(t,f),g&&g.m(t,null),l=!0,d||(c=[Wt(zt.call(null,a,{})),Q(a,"inview_init",e[6]),Q(a,"inview_change",e[6])],d=!0)},p(h,[p]){h[3].length===0?u||(u=Tt(),u.c(),u.m(t,n)):u&&(u.d(1),u=null),h[4]?w&&(w.d(1),w=null):w?w.p(h,p):(w=Nt(h),w.c(),w.m(t,i)),p&11&&(k=_t(h[3]),ve(),o=Ee(o,p,y,1,h,k,s,t,be,Ot,r,Dt),ke()),h[2]?g&&(g.d(1),g=null):g||(g=At(),g.c(),g.m(t,null))},i(h){if(!l){for(let p=0;p<k.length;p+=1)ct(o[p]);l=!0}},o(h){for(let p=0;p<o.length;p+=1)Et(o[p]);l=!1},d(h){h&&N(t),u&&u.d(),w&&w.d();for(let p=0;p<o.length;p+=1)o[p].d();g&&g.d(),d=!1,T(c)}}}const wn=1;function yn(e,t,n){let{plugin:i}=t,{leaf:o}=t,s,r=[],a=[],f=!0,l=!1,d=!0;function c(){const p=m.moment();gn(p,s)||n(4,d=!1)}function u(){return $e(this,void 0,void 0,function*(){const p=Mt().format||"YYYY-MM-DD",b=m.moment();if(!d){const M=yield hn(b);a.push(M),n(3,a=a.sort((F,O)=>parseInt(m.moment(O.basename,p).format("x"))-parseInt(m.moment(F.basename,p).format("x")))),n(4,d=!0)}})}function w(){!l||!f||(r.length===0&&l?n(2,f=!1):n(3,a=[...a,...r.splice(0,wn)]))}function k(){n(3,a)}function y(){c()}function g(p){const b=Ft(p,"day"),M=Mt().format||"YYYY-MM-DD";if(!b)return;function F(B){return B.sort((ae,le)=>m.moment(le.basename,M).valueOf()-m.moment(ae.basename,M).valueOf())}if(a.length===0){r.push(p),n(12,r=F(r));return}const O=a[a.length-1],S=a[0],_=m.moment(O.basename,M),$=m.moment(S.basename,M);b.isBetween(_,$)?(a.push(p),n(3,a=F(a))):b.isBefore(_)?(r.push(p),n(12,r=F(r))):b.isAfter($)&&(a.push(p),n(3,a=F(a))),b.isSame(m.moment(),"day")&&n(4,d=!0)}function h(p){Ft(p,"day")&&(n(3,a=a.filter(b=>b.basename!==p.basename)),n(12,r=r.filter(b=>b.basename!==p.basename)),c())}return e.$$set=p=>{"plugin"in p&&n(0,i=p.plugin),"leaf"in p&&n(1,o=p.leaf)},e.$$.update=()=>{if(e.$$.dirty&14340&&f&&!l){n(11,s=pn());for(const p of Object.keys(s).sort().reverse())r.push(s[p]);n(13,l=!0),c()}},[i,o,f,a,d,u,w,k,y,g,h,s,r,l]}class vn extends qt{constructor(t){super(),jt(this,t,yn,mn,Yt,{plugin:0,leaf:1,tick:7,check:8,fileCreate:9,fileDelete:10})}get tick(){return this.$$.ctx[7]}get check(){return this.$$.ctx[8]}get fileCreate(){return this.$$.ctx[9]}get fileDelete(){return this.$$.ctx[10]}}function rt(e,t){const n=Object.keys(t).map(i=>kn(e,i,t[i]));return n.length===1?n[0]:function(){n.forEach(i=>i())}}function kn(e,t,n){const i=e[t],o=e.hasOwnProperty(t);let s=n(i);return i&&Object.setPrototypeOf(s,i),Object.setPrototypeOf(r,s),e[t]=r,a;function r(...f){return s===i&&e[t]===r&&a(),s.apply(this,f)}function a(){e[t]===r&&(o?e[t]=i:delete e[t]),s!==i&&(s=i,Object.setPrototypeOf(r,i||Function))}}const bn=()=>{m.addIcon("daily-note",'<svg width="103" height="134" viewBox="0 0 103 134" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M60.3446 21.848H22.5577C19.5764 21.848 17.1595 24.2648 17.1595 27.2462V65.0331C17.1595 68.0144 19.5764 70.4312 22.5577 70.4312H60.3446C63.3259 70.4312 65.7428 68.0144 65.7428 65.0331V27.2462C65.7428 24.2648 63.3259 21.848 60.3446 21.848Z" stroke="#5C1111" stroke-width="4.81618" stroke-linecap="round" stroke-linejoin="round"/><path d="M52.2476 16.4498V27.2461" stroke="#5C1111" stroke-width="4.81618" stroke-linecap="round" stroke-linejoin="round"/><path d="M30.655 16.4498V27.2461" stroke="#5C1111" stroke-width="4.81618" stroke-linecap="round" stroke-linejoin="round"/><path d="M17.1595 38.0424H65.7428" stroke="#5C1111" stroke-width="4.81618" stroke-linecap="round" stroke-linejoin="round"/><path d="M33.3541 54.2366L38.7523 59.6348L49.5485 48.8385" stroke="#5C1111" stroke-width="4.81618" stroke-linecap="round" stroke-linejoin="round"/><g filter="url(#filter0_ddddd_104_2)"><path d="M12.181 103.617L9.21851 95.8213L27.9292 87.0896L66.754 71.4973L93.1049 88.8047L91.3898 103.617H12.181Z" fill="#AC4DD9" stroke="black" stroke-width="0.963236"/><path d="M12.181 103.617L9.21851 95.9771L27.9292 87.0895L32.6069 103.461L12.181 103.617Z" fill="#540D75" stroke="black" stroke-width="0.963236"/><path d="M9.0625 95.6652L25.7894 67.212L27.9291 87.0894L9.21842 95.977L9.0625 95.6652Z" fill="#470068" stroke="black" stroke-width="0.481618"/><path d="M27.9291 87.0896L25.9021 66.8197L67.5335 56.2169L66.5979 71.4973L27.9291 87.0896Z" fill="#732E94" stroke="black" stroke-width="0.963236"/><path d="M66.598 71.4971L67.9466 56.3527L93.1049 88.8045L66.598 71.4971Z" fill="#C279E4" stroke="black" stroke-width="0.481618"/><path d="M9.0625 95.6652L25.7462 66.8195L67.9465 56.0808L93.1049 88.8046L66.598 71.4972L27.9291 87.0895L9.21842 95.9771L9.0625 95.6652Z" stroke="black" stroke-width="0.963236"/><path d="M26.0579 103.617L27.9289 87.0895L32.7625 103.617H26.0579Z" fill="#61018E" stroke="black" stroke-width="0.963236"/></g><defs><filter id="filter0_ddddd_104_2" x="0.0874329" y="53.8502" width="101.958" height="79.8707" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/><feOffset/><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"/><feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_104_2"/><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/><feOffset dy="1.20405"/><feGaussianBlur stdDeviation="1.44485"/><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"/><feBlend mode="normal" in2="effect1_dropShadow_104_2" result="effect2_dropShadow_104_2"/><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/><feOffset dy="5.2978"/><feGaussianBlur stdDeviation="2.6489"/><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.09 0"/><feBlend mode="normal" in2="effect2_dropShadow_104_2" result="effect3_dropShadow_104_2"/><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/><feOffset dy="11.7996"/><feGaussianBlur stdDeviation="3.61213"/><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.05 0"/><feBlend mode="normal" in2="effect3_dropShadow_104_2" result="effect4_dropShadow_104_2"/><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/><feOffset dy="21.1912"/><feGaussianBlur stdDeviation="4.21416"/><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.01 0"/><feBlend mode="normal" in2="effect4_dropShadow_104_2" result="effect5_dropShadow_104_2"/><feBlend mode="normal" in="SourceGraphic" in2="effect5_dropShadow_104_2" result="shape"/></filter></defs></svg>')},En={hideFrontmatter:!1,hideBacklinks:!1};class Sn extends m.PluginSettingTab{constructor(t,n){super(t,n),this.debounceApplySettingsUpdate=m.debounce(async()=>{await this.plugin.saveSettings()},200,!0),this.debounceDisplay=m.debounce(async()=>{await this.display()},400,!0),this.plugin=n}applySettingsUpdate(){this.debounceApplySettingsUpdate()}async display(){await this.plugin.loadSettings();const{containerEl:t}=this,n=this.plugin.settings;t.toggleClass("daily-note-settings-container",!0),t.empty(),new m.Setting(t).setName("Hide frontmatter").setDesc("Hide frontmatter in daily notes").addToggle(i=>i.setValue(n.hideFrontmatter).onChange(async o=>{this.plugin.settings.hideFrontmatter=o,document.body.classList.toggle("daily-notes-hide-frontmatter",o),this.applySettingsUpdate()})),new m.Setting(t).setName("Hide backlinks").setDesc("Hide backlinks in daily notes").addToggle(i=>i.setValue(n.hideBacklinks).onChange(async o=>{this.plugin.settings.hideBacklinks=o,document.body.classList.toggle("daily-notes-hide-backlinks",o),this.applySettingsUpdate()}))}}const j="daily-note-editor-view";function Ln(e){return e.containerEl.matches(".dn-leaf-view")}class _n extends m.ItemView{constructor(t,n){super(t),this.onFileCreate=i=>{i instanceof m.TFile&&this.view.fileCreate(i)},this.onFileDelete=i=>{i instanceof m.TFile&&this.view.fileDelete(i)},this.plugin=n,this.scope=new m.Scope(n.app.scope)}getViewType(){return j}getDisplayText(){return"Daily Note"}getIcon(){return"daily-note"}async onOpen(){this.scope.register(["Mod"],"f",t=>{}),this.view=new vn({target:this.contentEl,props:{plugin:this.plugin,leaf:this.leaf}}),this.app.vault.on("create",this.onFileCreate),this.app.vault.on("delete",this.onFileDelete),this.app.workspace.onLayoutReady(this.view.tick.bind(this)),this.registerInterval(window.setInterval(async()=>{this.view.check()},1e3*60*60))}}class $n extends m.Plugin{async onload(){this.addSettingTab(new Sn(this.app,this)),await this.loadSettings(),this.patchWorkspace(),this.patchWorkspaceLeaf(),bn(),this.registerView(j,t=>this.view=new _n(t,this)),this.addRibbonIcon("daily-note","Open Daily Note Editor",t=>this.openDailyNoteEditor()),this.addCommand({id:"open-daily-note-editor",name:"Open Daily Note Editor",callback:()=>this.openDailyNoteEditor()}),this.initCssRules()}onunload(){this.app.workspace.detachLeavesOfType(j),document.body.toggleClass("daily-notes-hide-frontmatter",!1),document.body.toggleClass("daily-notes-hide-backlinks",!1)}async openDailyNoteEditor(){const t=this.app.workspace;t.detachLeavesOfType(j);const n=t.getLeaf(!0);await n.setViewState({type:j}),t.revealLeaf(n)}initCssRules(){document.body.toggleClass("daily-notes-hide-frontmatter",this.settings.hideFrontmatter),document.body.toggleClass("daily-notes-hide-backlinks",this.settings.hideBacklinks)}patchWorkspace(){let t=!1;const n=rt(m.Workspace.prototype,{changeLayout(i){return async function(o){t=!0;try{await i.call(this,o)}finally{t=!1}}},iterateLeaves(i){return function(o,s){if(i.call(this,o,s))return!0;const r=typeof o=="function"?o:s,a=typeof o=="function"?s:o;if(!a||t)return!1;if(a===app.workspace.rootSplit||m.WorkspaceContainer&&a instanceof m.WorkspaceContainer){for(const f of Z.popoversForWindow(a.win))if(i.call(this,r,f.rootSplit))return!0}return!1}},setActiveLeaf:i=>function(o,s){if(o.parentLeaf){o.parentLeaf.activeTime=17e11,i.call(this,o.parentLeaf,s),o.view.editMode&&(this.activeEditor=o.view);return}i.call(this,o,s)},onDragLeaf(i){return function(o,s){return i.call(this,o,s)}}});this.register(n)}patchWorkspaceLeaf(){this.register(rt(m.WorkspaceLeaf.prototype,{getRoot(t){return function(){const n=t.call(this);return(n==null?void 0:n.getRoot)===this.getRoot?n:n==null?void 0:n.getRoot()}},setPinned(t){return function(n){t.call(this,n),$t(this)&&!n&&this.setPinned(!0)}},openFile(t){return function(n,i){if($t(this)){setTimeout(rt(m.Workspace.prototype,{recordMostRecentOpenedFile(s){return function(r){if(r!==n)return s.call(this,r)}}}),1);const o=this.app.plugins.plugins["recent-files-obsidian"];o&&setTimeout(rt(o,{shouldAddFile(s){return function(r){return r!==n&&s.call(this,r)}}}),1)}return t.call(this,n,i)}}}))}async loadSettings(){this.settings=Object.assign({},En,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}}exports.DAILY_NOTE_VIEW_TYPE=j;exports.default=$n;exports.isEmebeddedLeaf=Ln;
